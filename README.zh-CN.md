# TOTP Manager

[English](README.md) | ç®€ä½“ä¸­æ–‡

ğŸ“š **[Documentation Index](DOCUMENTATION_INDEX.md)** | **[æ–‡æ¡£ç´¢å¼•](DOCUMENTATION_INDEX.zh-CN.md)**

åŸºäº Cloudflare Pages + Vue 3 çš„ TOTP ç®¡ç†å™¨ï¼Œé‡‡ç”¨ Material Design é£æ ¼ï¼Œæ”¯æŒ 18 ç§è¯­è¨€å›½é™…åŒ–ã€‚

## é¡¹ç›®ç®€ä»‹

TOTP Manager æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„åŸºäºæ—¶é—´çš„ä¸€æ¬¡æ€§å¯†ç ï¼ˆTOTPï¼‰ç®¡ç†åº”ç”¨ï¼Œå®Œå…¨åœ¨æµè§ˆå™¨ä¸­ç”Ÿæˆ TOTP ä»¤ç‰Œï¼Œæ— éœ€é¢‘ç¹è°ƒç”¨æœåŠ¡å™¨ã€‚åº”ç”¨é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå‰ç«¯ä½¿ç”¨ Vue 3 + Vite æ„å»ºï¼Œåç«¯ä½¿ç”¨ Cloudflare Pages Functions æä¾› API æœåŠ¡ï¼Œæ•°æ®å­˜å‚¨ä½¿ç”¨ Cloudflare D1 æ•°æ®åº“ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ” **å®¢æˆ·ç«¯ TOTP ç”Ÿæˆ** - ä»¤ç‰Œå®Œå…¨åœ¨æµè§ˆå™¨ä¸­ç”Ÿæˆï¼Œå‡å°‘æœåŠ¡å™¨è°ƒç”¨ï¼Œæé«˜å“åº”é€Ÿåº¦
- ğŸ¨ **Material Design 3** - é‡‡ç”¨ Google Material Design è®¾è®¡è§„èŒƒï¼Œæä¾›ç°ä»£åŒ–çš„ç”¨æˆ·ç•Œé¢
- ğŸŒ **18 ç§è¯­è¨€æ”¯æŒ** - å®Œæ•´çš„å›½é™…åŒ–æ”¯æŒï¼ŒåŒ…æ‹¬ RTL å¸ƒå±€ï¼ˆé˜¿æ‹‰ä¼¯è¯­ï¼‰
- ğŸŒ“ **æ˜æš—ä¸»é¢˜** - æ”¯æŒæ˜æš—ä¸»é¢˜åˆ‡æ¢å’Œè‡ªåŠ¨ä¸»é¢˜æ£€æµ‹
- ğŸ“± **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- ğŸ“· **äºŒç»´ç æ‰«æ** - æ”¯æŒä¸Šä¼ äºŒç»´ç å›¾ç‰‡è‡ªåŠ¨è§£æ TOTP é…ç½®
- ğŸ’¾ **åŒæ¨¡å¼å­˜å‚¨** - æ”¯æŒäº‘ç«¯åŒæ­¥ï¼ˆéœ€ç™»å½•ï¼‰å’Œæœ¬åœ°å­˜å‚¨ï¼ˆä¸´æ—¶æ¨¡å¼ï¼‰
- ğŸ” **å®æ—¶æœç´¢** - å®¢æˆ·ç«¯å®æ—¶æœç´¢å’Œè¿‡æ»¤ï¼Œæ— éœ€æœåŠ¡å™¨è°ƒç”¨
- ğŸ“´ **ç¦»çº¿æ”¯æŒ** - ä½¿ç”¨ Service Worker å®ç°ç¦»çº¿è®¿é—®
- ğŸ”’ **å®‰å…¨æ€§** - PBKDF2-SHA256 å¯†ç å“ˆå¸Œï¼ŒHttpOnly Cookieï¼ŒCSP å®‰å…¨å¤´

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: Vue 3 (Composition API) + TypeScript
- **æ„å»ºå·¥å…·**: Vite 5
- **UI æ¡†æ¶**: Vuetify 3 (Material Design)
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router 4
- **å›½é™…åŒ–**: Vue I18n
- **äºŒç»´ç **: jsQR

### åç«¯
- **è¿è¡Œæ—¶**: Cloudflare Pages Functions
- **æ•°æ®åº“**: Cloudflare D1 (SQLite)
- **åŠ å¯†**: Web Crypto API (PBKDF2-SHA256)

### å¼€å‘å·¥å…·
- **è¯­è¨€**: TypeScript
- **ä»£ç è´¨é‡**: ESLint + Prettier
- **æµ‹è¯•**: Vitest (å•å…ƒæµ‹è¯•)

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js 18+ 
- npm æˆ– yarn
- Cloudflare è´¦æˆ·ï¼ˆç”¨äºéƒ¨ç½²ï¼‰
- Wrangler CLIï¼ˆç”¨äºæ•°æ®åº“ç®¡ç†å’Œéƒ¨ç½²ï¼‰

### å®‰è£…

1. **å…‹éš†ä»“åº“**

```bash
git clone <repository-url>
cd totp-manager
```

2. **å®‰è£…ä¾èµ–**

```bash
npm install
```

3. **å®‰è£… Wrangler CLI**ï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰

```bash
npm install -g wrangler
```

4. **ç™»å½• Cloudflare**

```bash
wrangler login
```

### æœ¬åœ°å¼€å‘

1. **åˆå§‹åŒ–æœ¬åœ°æ•°æ®åº“**

```bash
# åˆ›å»ºæ•°æ®åº“ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
npm run db:create

# åº”ç”¨æ•°æ®åº“è¿ç§»
npm run db:migrate:local
```

2. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**

```bash
npm run dev
```

åº”ç”¨å°†åœ¨ `http://localhost:5173` å¯åŠ¨ã€‚

3. **å¯åŠ¨ Wrangler å¼€å‘æœåŠ¡å™¨**ï¼ˆç”¨äºæµ‹è¯• Functionsï¼‰

åœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£ä¸­è¿è¡Œï¼š

```bash
wrangler pages dev dist --local
```

### æ„å»º

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# é¢„è§ˆç”Ÿäº§æ„å»º
npm run preview
```

## æ•°æ®åº“ç®¡ç†

### æœ¬åœ°å¼€å‘

```bash
# åˆ›å»ºæ•°æ®åº“ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
npm run db:create

# åº”ç”¨è¿ç§»åˆ°æœ¬åœ°æ•°æ®åº“
npm run db:migrate:local

# æŸ¥çœ‹æœ¬åœ°è¿ç§»åˆ—è¡¨
npm run db:list:local

# æ‰§è¡Œ SQL æŸ¥è¯¢ï¼ˆæœ¬åœ°ï¼‰
npm run db:query:local -- --command "SELECT * FROM users"
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
# åº”ç”¨è¿ç§»åˆ°è¿œç¨‹æ•°æ®åº“
npm run db:migrate:remote

# æŸ¥çœ‹è¿œç¨‹è¿ç§»åˆ—è¡¨
npm run db:list:remote

# æ‰§è¡Œ SQL æŸ¥è¯¢ï¼ˆè¿œç¨‹ï¼‰
npm run db:query:remote -- --command "SELECT COUNT(*) FROM users"
```

### åˆ›å»ºæ–°è¿ç§»

1. åœ¨ `migrations/` ç›®å½•åˆ›å»ºæ–°æ–‡ä»¶ï¼Œå‘½åæ ¼å¼ï¼š`XXXX_description.sql`
2. ç¼–å†™ SQL è¿ç§»è„šæœ¬
3. åº”ç”¨è¿ç§»ï¼š`npm run db:migrate:local` æˆ– `npm run db:migrate:remote`

ç¤ºä¾‹ï¼š

```sql
-- migrations/0002_add_user_email.sql
ALTER TABLE users ADD COLUMN email TEXT;
CREATE INDEX IF NOT EXISTS idx_users_email ON users (email);
```

## éƒ¨ç½²åˆ° Cloudflare Pages

### é¦–æ¬¡éƒ¨ç½²

1. **åˆ›å»º D1 æ•°æ®åº“**

```bash
wrangler d1 create totp_db
```

å¤åˆ¶è¾“å‡ºçš„æ•°æ®åº“é…ç½®åˆ° `wrangler.toml`ï¼š

```toml
[[d1_databases]]
binding = "DATABASE"
database_name = "totp_db"
database_id = "your-database-id"  # æ›¿æ¢ä¸ºå®é™… ID
```

2. **åº”ç”¨æ•°æ®åº“è¿ç§»**

```bash
npm run db:migrate:remote
```

3. **è®¾ç½®ç¯å¢ƒå˜é‡**

```bash
# è®¾ç½®å¯†ç å“ˆå¸Œç›å€¼ï¼ˆå¿…éœ€ï¼‰
wrangler secret put HASH_SALT
# è¾“å…¥ä¸€ä¸ªå®‰å…¨çš„éšæœºå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼šyour-secure-random-salt-value
```

4. **æ„å»ºå¹¶éƒ¨ç½²**

```bash
npm run deploy
```

æˆ–è€…åˆ†æ­¥æ‰§è¡Œï¼š

```bash
# æ„å»º
npm run build

# éƒ¨ç½²
wrangler pages deploy dist
```

### åç»­éƒ¨ç½²

```bash
# ä¸€é”®éƒ¨ç½²ï¼ˆåŒ…å«æ„å»ºå’Œè¿ç§»ï¼‰
npm run deploy
```

### é€šè¿‡ Cloudflare Dashboard éƒ¨ç½²

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. è¿›å…¥ **Pages** éƒ¨åˆ†
3. ç‚¹å‡» **Create a project**
4. è¿æ¥ Git ä»“åº“
5. é…ç½®æ„å»ºè®¾ç½®ï¼š
   - **Build command**: `npm run build`
   - **Build output directory**: `dist`
6. æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
   - `HASH_SALT`: å¯†ç å“ˆå¸Œç›å€¼
   - `PW_ITERATIONS`: `100000`ï¼ˆå¯é€‰ï¼‰
7. ç»‘å®š D1 æ•°æ®åº“ï¼š
   - åœ¨ **Settings** â†’ **Functions** â†’ **D1 database bindings**
   - æ·»åŠ ç»‘å®šï¼š`DATABASE` â†’ é€‰æ‹©ä½ çš„æ•°æ®åº“
8. ç‚¹å‡» **Save and Deploy**

## ç¯å¢ƒå˜é‡é…ç½®

### å¿…éœ€çš„ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | è®¾ç½®æ–¹æ³• |
|--------|------|--------|----------|
| `HASH_SALT` | å¯†ç å“ˆå¸Œç›å€¼ï¼ˆå¿…éœ€ï¼‰ | æ—  | `wrangler secret put HASH_SALT` |

### å¯é€‰çš„ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | è®¾ç½®æ–¹æ³• |
|--------|------|--------|----------|
| `PW_ITERATIONS` | PBKDF2 è¿­ä»£æ¬¡æ•° | `100000` | åœ¨ `wrangler.toml` çš„ `[vars]` ä¸­è®¾ç½® |

### è®¾ç½®ç¯å¢ƒå˜é‡

**æ–¹æ³• 1: ä½¿ç”¨ Wrangler CLIï¼ˆæ¨èç”¨äºå¯†é’¥ï¼‰**

```bash
wrangler secret put HASH_SALT
```

**æ–¹æ³• 2: åœ¨ wrangler.toml ä¸­è®¾ç½®ï¼ˆç”¨äºéæ•æ„Ÿé…ç½®ï¼‰**

```toml
[vars]
PW_ITERATIONS = "100000"
```

**æ–¹æ³• 3: åœ¨ Cloudflare Dashboard ä¸­è®¾ç½®**

1. è¿›å…¥ Pages é¡¹ç›®è®¾ç½®
2. å¯¼èˆªåˆ° **Settings** â†’ **Environment variables**
3. æ·»åŠ å˜é‡
4. é‡æ–°éƒ¨ç½²é¡¹ç›®

### æœ¬åœ°å¼€å‘ç¯å¢ƒå˜é‡

åˆ›å»º `.dev.vars` æ–‡ä»¶ï¼ˆä¸è¦æäº¤åˆ° Gitï¼‰ï¼š

```bash
HASH_SALT=your-local-dev-salt
PW_ITERATIONS=100000
```

Wrangler ä¼šè‡ªåŠ¨åŠ è½½æ­¤æ–‡ä»¶ç”¨äºæœ¬åœ°å¼€å‘ã€‚

## è¯¦ç»†æ–‡æ¡£

- ğŸ“– [ç¯å¢ƒå˜é‡é…ç½®](ENVIRONMENT_VARIABLES.zh-CN.md) - è¯¦ç»†çš„ç¯å¢ƒå˜é‡æ–‡æ¡£
- ğŸš€ [CI/CD å·¥ä½œæµ](.github/workflows/README.zh-CN.md) - GitHub Actions é…ç½®æŒ‡å—
- ğŸ“‹ [å¿«é€Ÿå‚è€ƒ](QUICK_REFERENCE.zh-CN.md) - å¸¸ç”¨å‘½ä»¤å’Œé€ŸæŸ¥è¡¨

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

- âœ… **å®¢æˆ·ç«¯ TOTP ç”Ÿæˆ** - ä»¤ç‰Œå®Œå…¨åœ¨æµè§ˆå™¨ä¸­ç”Ÿæˆï¼Œæ— éœ€æœåŠ¡å™¨è°ƒç”¨
- âœ… **ç”¨æˆ·è®¤è¯** - æ”¯æŒç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ç™»å‡º
- âœ… **å¯†é’¥ç®¡ç†** - æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤ TOTP å¯†é’¥
- âœ… **äºŒç»´ç æ‰«æ** - ä¸Šä¼ äºŒç»´ç å›¾ç‰‡è‡ªåŠ¨è§£æé…ç½®
- âœ… **å®æ—¶æœç´¢** - å®¢æˆ·ç«¯å®æ—¶æœç´¢å’Œè¿‡æ»¤å¯†é’¥
- âœ… **æœ¬åœ°å­˜å‚¨æ¨¡å¼** - æ— éœ€ç™»å½•å³å¯ä½¿ç”¨ï¼ˆæ•°æ®å­˜å‚¨åœ¨æµè§ˆå™¨ï¼‰

### ç”¨æˆ·ç•Œé¢

- âœ… **Material Design 3** - ç°ä»£åŒ–çš„ Google Material Design ç•Œé¢
- âœ… **æ˜æš—ä¸»é¢˜** - æ”¯æŒæ˜æš—ä¸»é¢˜åˆ‡æ¢å’Œè‡ªåŠ¨æ£€æµ‹
- âœ… **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- âœ… **åŠ¨ç”»å’Œè¿‡æ¸¡** - æµç•…çš„ Material Design åŠ¨ç”»æ•ˆæœ

### å›½é™…åŒ–

- âœ… **18 ç§è¯­è¨€** - æ”¯æŒä»¥ä¸‹è¯­è¨€ï¼š
  - ç®€ä½“ä¸­æ–‡ (zh-CN)ã€ç¹ä½“ä¸­æ–‡ (zh-TW)ã€è‹±è¯­ (en)ã€æ—¥è¯­ (ja)ã€éŸ©è¯­ (ko)
  - æ³•è¯­ (fr)ã€å¾·è¯­ (de)ã€è¥¿ç­ç‰™è¯­ (es)ã€è‘¡è„ç‰™è¯­ (pt)ã€ä¿„è¯­ (ru)ã€æ„å¤§åˆ©è¯­ (it)
  - è·å…°è¯­ (nl)ã€æ³¢å…°è¯­ (pl)ã€åœŸè€³å…¶è¯­ (tr)ã€é˜¿æ‹‰ä¼¯è¯­ (ar)ã€å°å°¼è¯­ (id)ã€æ³°è¯­ (th)ã€è¶Šå—è¯­ (vi)
- âœ… **RTL æ”¯æŒ** - é˜¿æ‹‰ä¼¯è¯­è‡ªåŠ¨åˆ‡æ¢åˆ°ä»å³åˆ°å·¦å¸ƒå±€
- âœ… **è‡ªåŠ¨æ£€æµ‹** - æ ¹æ®æµè§ˆå™¨è¯­è¨€è‡ªåŠ¨é€‰æ‹©
- âœ… **è¯­è¨€æ‡’åŠ è½½** - ä¼˜åŒ–åˆå§‹åŠ è½½æ€§èƒ½

### æ€§èƒ½ä¼˜åŒ–

- âœ… **ä»£ç åˆ†å‰²** - è·¯ç”±å’Œç»„ä»¶æ‡’åŠ è½½
- âœ… **ç¦»çº¿æ”¯æŒ** - Service Worker å®ç°ç¦»çº¿è®¿é—®
- âœ… **é›¶ Function è°ƒç”¨** - é¡µé¢è®¿é—®ç›´æ¥è¿”å›é™æ€èµ„æº
- âœ… **å®¢æˆ·ç«¯è®¡ç®—** - TOTP ç”Ÿæˆå’Œæœç´¢åœ¨å®¢æˆ·ç«¯è¿›è¡Œ

### å®‰å…¨æ€§

- âœ… **PBKDF2-SHA256** - å¯†ç å“ˆå¸Œä½¿ç”¨ 100,000+ è¿­ä»£
- âœ… **HttpOnly Cookie** - ä¼šè¯ä»¤ç‰Œä½¿ç”¨ HttpOnly Cookie
- âœ… **å®‰å…¨å¤´** - CSPã€X-Frame-Optionsã€X-XSS-Protection
- âœ… **è¾“å…¥éªŒè¯** - å‰åç«¯åŒé‡éªŒè¯
- âœ… **ç¯å¢ƒå˜é‡** - æ•æ„Ÿé…ç½®é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†

## è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯: `git checkout -b feature/amazing-feature`
3. æäº¤æ›´æ”¹: `git commit -m 'Add amazing feature'`
4. æ¨é€åˆ°åˆ†æ”¯: `git push origin feature/amazing-feature`
5. æäº¤ Pull Request

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ– Pull Requestã€‚

---

**æ³¨æ„**: æœ¬é¡¹ç›®ä»…ç”¨äºå­¦ä¹ å’Œæ¼”ç¤ºç›®çš„ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰ï¼Œè¯·ç¡®ä¿ï¼š
- ä½¿ç”¨å¼ºéšæœºç›å€¼ï¼ˆ`HASH_SALT`ï¼‰
- å®šæœŸå¤‡ä»½æ•°æ®åº“
- å¯ç”¨ Cloudflare çš„å®‰å…¨åŠŸèƒ½ï¼ˆWAFã€Rate Limitingï¼‰
- ç›‘æ§åº”ç”¨æ€§èƒ½å’Œé”™è¯¯æ—¥å¿—
